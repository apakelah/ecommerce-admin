<%- include('partials/header') %>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-danger text-white">
                <h4><i class="bi bi-x-circle"></i> Cancel Purchase</h4>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle"></i>
                    <strong>Warning:</strong> Cancelling this purchase will return the stock to inventory.
                </div>
                
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5>Purchase Details</h5>
                    </div>
                    <div class="card-body">
                        <table class="table">
                            <tr>
                                <th>Transaction Code:</th>
                                <td><code><%= purchase.kode_transaksi %></code></td>
                            </tr>
                            <tr>
                                <th>Product:</th>
                                <td><%= purchase.nama_produk %></td>
                            </tr>
                            <tr>
                                <th>Customer:</th>
                                <td><%= purchase.nama_pembeli || 'N/A' %></td>
                            </tr>
                            <tr>
                                <th>Quantity:</th>
                                <td><%= purchase.jumlah %></td>
                            </tr>
                            <tr>
                                <th>Total Price:</th>
                                <td>Rp <%= purchase.total_harga.toLocaleString('id-ID') %></td>
                            </tr>
                            <tr>
                                <th>Purchase Date:</th>
                                <td><%= new Date(purchase.tanggal_pembelian).toLocaleDateString('id-ID') %></td>
                            </tr>
                        </table>
                    </div>
                </div>
                
                <form action="/cancel-purchase/<%= purchase.id %>" method="POST">
                    <div class="mb-3">
                        <label for="alasan_cancel" class="form-label">Cancellation Reason</label>
                        <textarea class="form-control" id="alasan_cancel" name="alasan_cancel" 
                                  rows="3" placeholder="Enter reason for cancellation..." required></textarea>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="/purchases" class="btn btn-secondary me-md-2">
                            <i class="bi bi-arrow-left"></i> Back
                        </a>
                        <button type="submit" class="btn btn-danger">
                            <i class="bi bi-x-circle"></i> Confirm Cancellation
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<%- include('partials/footer') %>